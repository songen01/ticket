(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7603:function(e,t,r){Promise.resolve().then(r.bind(r,8806)),Promise.resolve().then(r.t.bind(r,2391,23)),Promise.resolve().then(r.t.bind(r,9285,23))},8806:function(e,t,r){"use strict";r.r(t),r.d(t,{Header:function(){return K}});var n=r(3518),o=r(306),i=r(8305),s=r(2946),a=r(8781),l=r(7283),c=r(7960),d=r(5250),u=r(1491),h=r(17),g=r(265),x=r(3085),v=r(3033),f=r(9160),m=r(9197),j=r(6249),p=r(1321),w=r(5083),y=r(7520),b=r(3814),S=r.n(b),Z=r(4098),A=r(7851),P=r(7024),k=r(6381),_=r(8856);let K=()=>{var e;let[t,r]=m.useState(!1),b=(0,m.useRef)(!1),K=(0,p.GT)(e=>e.setAleoPrivateKey),N=(0,p.GT)(e=>e.setAleoAddress),C=(0,p.GT)(e=>e.Address),T=(0,p.GT)(e=>e.PK),[I,R]=(0,m.useState)(1),H=(0,m.useRef)();(0,m.useRef)();let[O,E]=m.useState(null),G=t?"simple-popover":void 0;(0,m.useEffect)(()=>{var e=indexedDB.open("aleoDB",1);e.onupgradeneeded=function(e){var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;r.objectStoreNames.contains("AleoStore")||r.createObjectStore("AleoStore",{keyPath:"id"})},e.onsuccess=function(e){var t=e.target.result,r=t.transaction(["AleoStore"],"readonly");r.objectStore("AleoStore").getAll().onsuccess=function(e){var t=e.target.result;window.localStorage.setItem("aleoRecords",JSON.stringify(t))},r.oncomplete=function(e){t.close()}}},[I]);let U=()=>{r(!1);let e=async e=>{var t;let r;if(b.current)return;H.current=(0,y.y)(),j||await (0,j.default)();let n=null==j?void 0:j.PrivateKey.from_string(T),o=null==n?void 0:n.to_view_key().to_string();null==j||j.ViewKey.from_string(o);let i=null==n?void 0:n.to_address().to_string();for(N(i),window.localStorage.setItem("aleoAddress",i),r=window.localStorage.getItem("aleoHeight")?parseInt(window.localStorage.getItem("aleoHeight")):0;;){b.current=!0;let e=await w.Z.get("https://chain.daosso.xyz/testnet3/latest/height").then(e=>e.data);console.log("current height: "+e);let n=await w.Z.get("https://aleo.daosso.xyz/records",{params:{start_block:r,end_block:r+1e3}});0===n.data.length&&(r>e?window.localStorage.setItem("aleoHeight",e.toString()):window.localStorage.setItem("aleoHeight",r.toString())),window.localStorage.setItem("aleoHeight",r.toString()),n.data.length>1&&(r=n.data[n.data.length-1].height);try{let e={viewKey:o,address:i,response:n.data,privateKey:T};null===(t=H.current)||void 0===t||t.postMessage(e)}catch(e){return}console.log(r),await new Promise(e=>setTimeout(e,3e3)),R(I+1)}};e()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"bg-gray-800 text-white p-4 fixed top-0 w-screen",children:(0,n.jsxs)("div",{className:"container mx-auto flex items-center justify-between",children:[(0,n.jsx)(S(),{href:"/",children:(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Swift Ticket"})}),(0,n.jsx)("nav",{children:(0,n.jsxs)("ul",{className:"flex space-x-4",children:[!C&&(0,n.jsx)("li",{children:(0,n.jsx)("span",{onClick:()=>{r(!0)},className:"hover:text-gray-300 cursor-pointer",children:" Connect"})}),(0,n.jsx)("li",{children:(0,n.jsx)(S(),{href:"/me",className:"hover:text-gray-300",children:"Me"})}),(0,n.jsx)("li",{children:C&&(0,n.jsx)("div",{"aria-describedby":G,variant:"contained",onClick:e=>{E(e.currentTarget)},children:"Profile"})})]})})]})}),(0,n.jsx)(o.ZP,{id:G,open:!!O,anchorEl:O,sx:{marginTop:4,maxHeight:700},onClose:()=>{E(null)},anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,n.jsxs)(A.Z,{sx:{width:345},children:[(0,n.jsx)(P.Z,{sx:{height:340},image:"https://i.seadn.io/gcs/files/7386920d3a2250737e9278e8d44cba47.gif?auto=format&dpr=1&w=640",title:"green iguana"}),(0,n.jsxs)(k.Z,{children:[(0,n.jsx)(Z.Z,{gutterBottom:!0,variant:"h5",component:"div",children:"Aleo!"}),(0,n.jsxs)(Z.Z,{variant:"body2",color:"text.secondary",children:["Address: ",C?C.slice(0,12)+"..."+C.slice(-12):"-"]})]}),(0,n.jsxs)(i.Z,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},children:[(0,n.jsx)(s.Z,{variant:"inset",component:"li"}),null===(e=JSON.parse(window?.localStorage.getItem("aleoRecords")))||void 0===e?void 0:e.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsxs)(a.ZP,{children:[(0,n.jsx)(l.Z,{children:(0,n.jsx)(c.Z,{children:(0,n.jsx)(_.Z,{})})}),(0,n.jsx)(d.Z,{primary:"Record",secondary:e.result})]}),(0,n.jsx)(s.Z,{variant:"inset",component:"li"})]},1))]})]})}),(0,n.jsxs)(u.Z,{open:t,onClose:U,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,n.jsx)(h.Z,{id:"alert-dialog-title",children:"Set your Private Key"}),(0,n.jsx)(g.Z,{children:(0,n.jsx)(x.Z,{autoFocus:!0,margin:"dense",id:"Private",label:"Private Key",type:"Private",fullWidth:!0,variant:"standard",onChange:e=>K(e.currentTarget.value)})}),(0,n.jsxs)(v.Z,{children:[(0,n.jsx)(f.Z,{onClick:U,children:"Cancel"}),(0,n.jsx)(f.Z,{onClick:U,autoFocus:!0,children:"OK!"})]})]})]})}},7520:function(e,t,r){"use strict";r.d(t,{a:function(){return o},y:function(){return n}});let n=()=>new Worker(r.tu(new URL(r.p+r.u(34),r.b))),o=()=>new Worker(r.tu(new URL(r.p+r.u(701),r.b)))},1321:function(e,t,r){"use strict";r.d(t,{GT:function(){return o}});var n=r(5760);let o=(0,n.Ue)(e=>({PK:"",Address:"",ViewKey:"",login:!1,setAleoPrivateKey:t=>e(e=>({PK:t})),setAleoAddress:t=>e(e=>({Address:t})),setAleoViewKey:t=>e(e=>({ViewKey:t})),setLogin:t=>e(e=>({login:!0}))}));(0,n.Ue)(e=>({loading:!1,setLoading:t=>e(e=>({loading:t}))})),(0,n.Ue)(e=>({records:[],setRecords:t=>e(e=>({records:t}))}))},2391:function(){}},function(e){e.O(0,[317,429,160,213,857,157,801,313,447,744],function(){return e(e.s=7603)}),_N_E=e.O()}]);